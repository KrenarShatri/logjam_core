<%= render "header" %>
<div id="logjam-container">
  <%= render "sidebar" %>
  <div id="show-json"><i class="fa fa-file-text-o"></i> <%= link_to("show json", params.merge(:format => :json)) %></div>
  <div id="logjam-content" class="app-dashboard">

    <h2><%= params[:app] %></h2>
    <div class="app-overview">

      <div class="item has-action">
        <% if @dataset.empty? -%>
        <p class="warning">Dataset is empty.</p>
        <% else -%>
          <h2>
            showing
            <%= number_with_delimiter @dataset.count_requests %> of <%= number_with_delimiter @dataset.count %> requests
          </h2>
          <%= render "navicons" %>
          <%= render :partial => "resource_plot", :locals => {:width => 450, :height => 200} %>
        <% end -%>
        <div class="action">
          <%= clean_link_to("view enlarged plot", { :page => without_module(@page), :action => "enlarged_plot", :interval => 1 }, :title => "view enlarged plot") %>
        </div>
      </div>
    </div>

    <div class="app-overview">

      <div class="item">
        <h2>Apdex Frontend</h2>
        <span class="value">0.94</span>
      </div>
      <%= render "apdex" %>
      <%= render "response_codes" %>
      <%= render "errors" %>

    </div>

    <% if params[:grouping] == "page" -%>
      <h2><%= params[:app] %> :: Resources (avg)</h2>
      <div id="performance-break-down" class="app-overview">
        <%= render "breakdown" %>
      </div>
    <% end -%>

    <div class="app-overview">
      <% unless @dataset.empty? -%>
      <div class="item">
        <div id="pagetimes">
          <h2><%= @dataset.description %>
            <%- if params[:grouping] == "request" -%>
            between <%= minute_to_human(@dataset.start_minute) %>
            and <%= minute_to_human(@dataset.end_minute) %>
            <%- end -%>
          </h2>
          <div>
          <%= render "page_times" %>
          </div>

        </div>
        <div class="action">
          <%= sometimes_link_all_pages %>
        </div>
      </div>
      <% end -%>
  </div>
</div>
